-- View: sharadar.balanceSheet

-- DROP VIEW sharadar.balanceSheet;

CREATE OR REPLACE VIEW sharadar.balanceSheet
 AS
 SELECT balanceSheet.ticker,
    balanceSheet.datekey,
    balanceSheet.accoci,
    balanceSheet.assets,
    balanceSheet.assetsc,
    balanceSheet.assetsnc,
    balanceSheet.bvps,
    balanceSheet.capex,
    balanceSheet.cashneq,
    balanceSheet.cashnequsd,
    balanceSheet.cor,
    balanceSheet.consolinc,
    balanceSheet.currentratio,
    balanceSheet.de,
    balanceSheet.debt,
    balanceSheet.debtc,
    balanceSheet.debtnc,
    balanceSheet.debtusd,
    balanceSheet.deferredrev,
    balanceSheet.depamor,
    balanceSheet.deposits,
    balanceSheet.divyield,
    balanceSheet.dps,
    balanceSheet.ebit,
    balanceSheet.ebitda,
    balanceSheet.ebitdamargin,
    balanceSheet.ebitdausd,
    balanceSheet.ebitusd,
    balanceSheet.ebt,
    balanceSheet.eps,
    balanceSheet.epsdil,
    balanceSheet.epsusd,
    balanceSheet.equity,
    balanceSheet.equityusd,
    balanceSheet.ev,
    balanceSheet.evebit,
    balanceSheet.evebitda,
    balanceSheet.fcf,
    balanceSheet.fcfps,
    balanceSheet.fxusd,
    balanceSheet.gp,
    balanceSheet.grossmargin,
    balanceSheet.intangibles,
    balanceSheet.intexp,
    balanceSheet.invcap,
    balanceSheet.inventory,
    balanceSheet.investments,
    balanceSheet.investmentsc,
    balanceSheet.investmentsnc,
    balanceSheet.liabilities,
    balanceSheet.liabilitiesc,
    balanceSheet.liabilitiesnc,
    balanceSheet.ncf,
    balanceSheet.ncfbus,
    balanceSheet.ncfcommon,
    balanceSheet.ncfdebt,
    balanceSheet.ncfdiv,
    balanceSheet.ncff,
    balanceSheet.ncfi,
    balanceSheet.ncfinv,
    balanceSheet.ncfo,
    balanceSheet.ncfx,
    balanceSheet.netinc,
    balanceSheet.netinccmn,
    balanceSheet.netinccmnusd,
    balanceSheet.netincdis,
    balanceSheet.netincnci,
    balanceSheet.netmargin,
    balanceSheet.opex,
    balanceSheet.opinc,
    balanceSheet.payables,
    balanceSheet.payoutratio,
    balanceSheet.ppnenet,
    balanceSheet.prefdivis,
    balanceSheet.receivables,
    balanceSheet.retearn,
    balanceSheet.revenue,
    balanceSheet.revenueusd,
    balanceSheet.rnd,
    balanceSheet.sbcomp,
    balanceSheet.sgna,
    balanceSheet.sharefactor,
    balanceSheet.sharesbas,
    balanceSheet.shareswa,
    balanceSheet.shareswadil,
    balanceSheet.sps,
    balanceSheet.tangibles,
    balanceSheet.taxassets,
    balanceSheet.taxexp,
    balanceSheet.taxliabilities,
    balanceSheet.tbvps,
    balanceSheet.workingcapital
   FROM ( SELECT sf1.ticker,
            sf1.dimension,
            sf1.calendardate,
            sf1.datekey,
            sf1.reportperiod,
            sf1.lastupdated,
            sf1.accoci,
            sf1.assets,
            sf1.assetsc,
            sf1.assetsnc,
            sf1.bvps,
            sf1.capex,
            sf1.cashneq,
            sf1.cashnequsd,
            sf1.cor,
            sf1.consolinc,
            sf1.currentratio,
            sf1.de,
            sf1.debt,
            sf1.debtc,
            sf1.debtnc,
            sf1.debtusd,
            sf1.deferredrev,
            sf1.depamor,
            sf1.deposits,
            sf1.divyield,
            sf1.dps,
            sf1.ebit,
            sf1.ebitda,
            sf1.ebitdamargin,
            sf1.ebitdausd,
            sf1.ebitusd,
            sf1.ebt,
            sf1.eps,
            sf1.epsdil,
            sf1.epsusd,
            sf1.equity,
            sf1.equityusd,
            sf1.ev,
            sf1.evebit,
            sf1.evebitda,
            sf1.fcf,
            sf1.fcfps,
            sf1.fxusd,
            sf1.gp,
            sf1.grossmargin,
            sf1.intangibles,
            sf1.intexp,
            sf1.invcap,
            sf1.inventory,
            sf1.investments,
            sf1.investmentsc,
            sf1.investmentsnc,
            sf1.liabilities,
            sf1.liabilitiesc,
            sf1.liabilitiesnc,
            sf1.ncf,
            sf1.ncfbus,
            sf1.ncfcommon,
            sf1.ncfdebt,
            sf1.ncfdiv,
            sf1.ncff,
            sf1.ncfi,
            sf1.ncfinv,
            sf1.ncfo,
            sf1.ncfx,
            sf1.netinc,
            sf1.netinccmn,
            sf1.netinccmnusd,
            sf1.netincdis,
            sf1.netincnci,
            sf1.netmargin,
            sf1.opex,
            sf1.opinc,
            sf1.payables,
            sf1.payoutratio,
            sf1.ppnenet,
            sf1.prefdivis,
            sf1.receivables,
            sf1.retearn,
            sf1.revenue,
            sf1.revenueusd,
            sf1.rnd,
            sf1.sbcomp,
            sf1.sgna,
            sf1.sharefactor,
            sf1.sharesbas,
            sf1.shareswa,
            sf1.shareswadil,
            sf1.sps,
            sf1.tangibles,
            sf1.taxassets,
            sf1.taxexp,
            sf1.taxliabilities,
            sf1.tbvps,
            sf1.workingcapital,
            row_number() OVER (PARTITION BY sf1.ticker, sf1.dimension, sf1.calendardate, sf1.datekey, sf1.reportperiod ORDER BY sf1.lastupdated DESC) AS row_number
           FROM sharadar.sf1) balanceSheet
  WHERE balanceSheet.row_number = 1 AND balanceSheet.dimension = 'ARQ'::text;

ALTER TABLE sharadar.balanceSheet
    OWNER TO admin;

